<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  
  <!-- Bootstrap CSS has to come from a CDN (only way to have the ../fonts assets at glitch) -->
  <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/readable/bootstrap.min.css"
        rel="stylesheet" type="text/css">
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <!-- script src="https://watch.battleforthenet.com/widget.js" async></script -->
  <title>Multiplayer Go Fish</title>
  <meta property="og:title" content="Multiplayer Go Fish game @ Glitch"/>
  <meta property="og:type" content="game"/>
  <meta property="og:url" content="https://go-fish.glitch.me/"/>
  <meta property="og:image" content="https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fgo-fish-color.png?1493755260516"/>
  <meta property="og:description" content="Play with friends, or remix with your own deck"/>
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@TheRealDod" />
  <meta name="twitter:title" content="Multiplayer Go Fish game @ Glitch" />
  <meta name="twitter:description" content="Play with friends, or remix with your own deck" />
  <meta name="twitter:image" content="https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fgo-fish-color.png?1493755260516" />
  <meta name="twitter:url" content="https://go-fish.glitch.me/" />
  <meta name="flattr:id" content="kn9xpr">
  <link href="https://fonts.googleapis.com/css?family=Alef" rel="stylesheet">
  <link href="./Gameplex/public/css/style.css" rel="stylesheet" type="text/css">
  <link id="favicon" rel="icon" type="image/png" href=
  "https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fgo-fish-color.png?1493755260516">
  <script src="https://watch.battleforthenet.com/widget.js" async></script>
</head>
<body>
  <nav id="top-bar" class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-menu" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">
          <img src="https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fgo-fish-color.png?1493755260516">
          Go Fish
        </a>
      </div>
      <div id="top-menu" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><ul class="nav navbar-nav" id="cards-dropdown"></ul></li>
          <li><ul class="nav navbar-nav" id="ranks-dropdown"></ul></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><ul class="nav navbar-nav" id="deck-dropdown"></ul></li>
          <li>
            <a target="_blank" class="navbar-link"
                 href="https://github.com/thedod/glitch-go-fish/#readme">
              Help
            </a>
          </li>
          <li>
            <form class="navbar-form navbar-right" role="search">
              <div class="form-group">
                <button id="mute-button" type="button" class="btn btn-default active" data-toggle="button"
                        aria-pressed="true" autocomplete="off">
                  <span id="mute-icon" class="glyphicon glyphicon-volume-off"></span>
                </button>
              </div>
            </form>
          </li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>
  <div class="container">
    <div id="chat-page" class="row flex-row flex-grow">
      <div id="chat-area" class="col-xs-12 flex-col flex-grow">
        <div class="row flex-row flex-grow">
          <div id="messages-div" class=
               "col-xs-6 flex-col flex-grow text-info">
            <ul class="messages list-unstyled"></ul>
          </div>
          <div id="game-div" class="col-xs-6 flex-col">
            <h3>
              <span class="label label-default pull-right">
                <abbr title="Pile">
                  <img class="pull-left" style="height:1.5em; width: auto" alt="Pile"
                       src="https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fgo-fish-color.png?1493755260516">
                </abbr>
                &nbsp;
                <span id="pile-size">0</span>
              </span>
            </h3>
            <ul id="user-list" class="list-group"></ul>
            <ul id="hand-row" class="list-inline text-center"></ul>
          </div>
        </div>
        <div class="row flex-row">
          <div class="inputMessageDiv col-xs-12 flex-col">
            <input class="form-control inputMessage"
                   placeholder="Please wait..." disabled>
          </div>
        </div>
      </div>
    </div><!-- /#chat-page -->
  </div>
  <nav id="bottom-bar" class="navbar navbar-inverse navbar-fixed-bottom">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bottom-menu" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="#" id="username-brand" class="navbar-brand">
         <img alt="loading..."
              src="https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fajax-loader(2).gif?1493922133872">
        </a>
      </div>
      <div id="bottom-menu" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><p id="game-status" class="navbar-text">Connecting...</p></li>
        </ul>
        <ul id="play-bar" class="nav navbar-nav navbar-right"></ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>
  
  <div id="login-modal" class="modal" tabindex="-1" role="dialog"
       data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">Welcome to Go Fish</h3>
        </div>
        <div class="modal-body">
          <div class="jumbotron text-center">
            <div class="page-header">
              <h1>What's your nickname?</h1>
              <input type="text" class="usernameInput"
                     id="username" placeholder="Type your name..."/>
            </div>
          </div>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->        
  </div><!-- /.modal -->

  <div id="invite-modal" class="modal" tabindex="-1" role="dialog"
       data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title">
            üëãInvite friends
          </h4>
        </div>
        <div class="modal-body">
          <div class="media">
            <div class="media-left">
              <img class="img-qr hidden-xs hidden-sm" alt="QR Code"
                   src="https://cdn.glitch.com/ccb30db3-78cd-46da-af4b-a75cabfc5233%2Fqr-invite.png?1497641460005">
            </div>
            <div class="media-body">
              <textarea class="form-control" readonly id="invite-textarea">Want to play "Go Fish" with me? Waiting for you at https://go-fish.glitch.me</textarea>
              <button class="copy-btn btn btn-success form-control" data-clipboard-target="#invite-textarea">
                <span class="glyphicon glyphicon-copy"></span>
                Copy and send to a friend
              </button>
            </div>
          </div>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->        
  </div><!-- /.modal -->
  
  <div id="game-over-modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h3 class="modal-title">Game over <small>it takes 2 to go fish</small></h3>
        </div>
        <div class="modal-body">
          <div class="page-header text-center">
            <h3>
              üèÜ Game over. Well done. üèÜ
            </h3>
          </div>
          <div class="well text-center">
            <dl class="dl-horizontal" id="score"></dl>              
          </div>
          <p class="lead">
            In order to join a new game, refresh the page.<br>
            <small>
              This makes you leave the room, join it again,
              and draw new cards from a fresh pile.
            </small>
          </p>
          <p>
            If you don't refresh, you can still stay here and chat.
          </p>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->        
  </div><!-- /.modal -->
  
  <div id="card-modals"></div>
  <div id="rank-modals"></div>

  <!-- Begin Mustache templates
    Mustache documentation recommends adding templates to
    html gile as scripts:
    https://github.com/janl/mustache.js#include-templates
    The problem with this approach is that syntax-aware editors
    don't highlight, properly indent, etc. the code.
    To overcome this, we use templates as div.mustache elements
    (hidden in CSS).
    The problem with this approach is id collision in case of
    singletons (e.g #items, as opposed to #item-{{ n }}).
    The tweak arround this is to add a dummy var to such an id
    e.g. <div id="{{_}}items" ...>: {{_}} evaluates to the value
    of the uninitialized variable _ (i.e. an empty string).
  -->
  <div id="card-modal-template" class="mustache">
    <div id="{{ hash_id }}-modal" class="modal fade card-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h3 class="modal-title">{{{ rank_symbol }}} {{ rank }} / {{{ suit_symbol }}} {{ suit }}</h3>
          </div>
          <div class="modal-body">
            <div class="media">
              <div class="media-left">
              <a title="{{ desc }}" target="_blank" href="{{ src }}">
                <img src="{{ src }}" alt="{{ desc }}" />
              </a>
              </div>
              <div class="media-body">
                <h4 class="media-heading">
                  <a target="_blank" href="card.html#{{ rank }}/{{ suit }}"><span class="glyphicon glyphicon-link"></span></a>
                  {{ desc }}
                </h4>
                <div class="card-body">
                  {{{ body }}}
                </div>
              </div>
            </div>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
  </div>

  <div id="rank-modal-template" class="mustache">
    <div id="{{_}}{{ hash_id }}-modal" class="modal fade rank-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h3 class="modal-title">{{{ symbol }}} {{ name }}</h3>
          </div>
          <div class="modal-body">
            <div class="well">
              <p class="lead">{{{desc}}}</p>
              {{{body}}}
            </div>
            <ul class="media-list">
              {{#cards}}
              <li class="media">
                <div class="media-left">
                  <a title="{{ desc }}" target="_blank" href="{{ src }}">
                    <img src="{{ src }}" alt="{{ desc }}" />
                  </a>
                </div>
                <div class="media-body">
                  <h4 class="media-heading">
                    <a target="_blank" href="card.html#{{ rank }}/{{ suit }}"><span class="glyphicon glyphicon-link"></span></a>
                    {{ desc }}
                  </h4>
                  <div class="card-body">
                    {{{ body }}}
                  </div>
                </div>
              </li>
              {{/cards}}
            </ul>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
  </div>
  
  <div id="card-dropdown-template" class="mustache">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
         aria-expanded="false">Cards <span class="caret"></span></a>
      <ul class="dropdown-menu" id="cards-menu">
        {{#cards}}
          <li>
            <button type="button" class="btn btn-default form-control card-menu-item" data-toggle="modal"
                    title="{{ desc }} ({{{ rank_symbol }}} {{ rank }} / {{{ suit_symbol }}} {{ suit }})"
                    data-target="#{{ hash_id }}-modal">
              {{{ rank_symbol }}} {{rank}} / {{{ suit_symbol }}} {{ suit }}
            </button>
          </li>
        {{/cards}}
      </ul>
    </li>
  </div>

  <div id="rank-dropdown-template" class="mustache">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
         aria-expanded="false">{{#is_deck}}Full deck{{/is_deck}}{{^is_deck}}Ranks{{/is_deck}} <span class="caret"></span></a>
      <ul class="dropdown-menu" id="ranks-menu">
        {{#ranks}}
          <li>
            <button type="button" class="btn btn-default form-control rank-menu-item" data-toggle="modal"
                    title="{{{ symbol }}} {{ name }}"
                    data-target="#{{ hash_id }}-modal">
              {{{ symbol }}} {{name}}
            </button>
          </li>
        {{/ranks}}
      </ul>
    </li>
  </div>

  <div id="user-template" class="mustache">
    <div class="label label-default pull-right">
      {{#user.ranks}}
        <abbr title="{{ name }}">{{{ symbol }}}</abbr>
      {{/user.ranks}}
      {{#user.hand_size}}<span>{{.}}</span>{{/user.hand_size}}
      {{^user.hand_size}}&nbsp;{{/user.hand_size}}
    </div>
    {{#me}}
    <abbr title="Me">
      <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
    </abbr>
    {{/me}}
    {{{ user.name }}}
    {{#playing}}
      <span class="glyphicon glyphicon-hand-left" aria-hidden="true"></span>
    {{/playing}}
    {{#typing}}
      <span class="glyphicon glyphicon-pencil" aria-hidden="true"/>
    {{/typing}}
  </div>

  <div id="hand-row-template" class="mustache">
    {{#cards}}
    <li>
      <button type="button" class="btn btn-default" data-toggle="modal"
              title="{{ desc }} ({{{ rank_symbol }}} {{ rank }} / {{{ suit_symbol }}} {{ suit }})"
              data-target="#{{ hash_id }}-modal">
        <img class="img-responsive thumbnail" src="{{ src }}" alt="{{ desc }}" />
      </button>
    </li>
    {{/cards}}
  </div>
  
  <div id="play-bar-template" class="mustache">
    <li><p class="navbar-text">Ask</p></li>
    <li>
      <ul class="nav navbar-nav" id="{{_}}play-with">
        <li class="dropdown active">
          <a id="{{_}}play-with-field" href="#" class="dropdown-toggle" data-toggle="dropdown"
             role="button" aria-haspopup="true" aria-expanded="false">
            <span class="glyphicon glyphicon-list" aria-hidden="true"></span>
          </a>
          <ul class="dropdown-menu" id="{{_}}who-select">
            {{#who}}
            <li>
              <a class="drop-select" href="#" data-value="{{ name }}" data-target="#play-with-field">
                {{ name }}
              </a>
            </li>
            {{/who}}
          </ul>
        </li>
      </ul>
    </li>
    <li><p class="navbar-text">for</p></li>
    <li>
      <ul class="nav navbar-nav" id="{{_}}play-rank">
        <li class="dropdown active">
          <a id="{{_}}play-rank-field" href="#" class="dropdown-toggle" data-toggle="dropdown"
             role="button" aria-haspopup="true" aria-expanded="false">
            <span class="glyphicon glyphicon-list" aria-hidden="true"></span>
          </a>
          <ul class="dropdown-menu" id="{{_}}rank-select">
            {{#ranks}}
            <li>
              <a class="drop-select" href="#" data-value="{{ name }}" data-target="#play-rank-field">
                {{{ symbol }}} {{ name }}
              </a>
            </li>
            {{/ranks}}
          </ul>
        </li>
      </ul>
    </li>
    <li><p class="navbar-text">of</p></li>
    <li>
      <ul class="nav navbar-nav" id="{{_}}play-suit">
        <li class="dropdown active">
          <a id="{{_}}play-suit-field"
            href="#" class="dropdown-toggle" data-toggle="dropdown"
             role="button" aria-haspopup="true" aria-expanded="false">
            <span class="glyphicon glyphicon-list" aria-hidden="true"></span>
          </a>
          <ul class="dropdown-menu" id="{{_}}suit-select">
            {{#suits}}
            <li>
              <a class="drop-select" href="#" data-value="{{ name }}" data-target="#play-suit-field">
                {{{ symbol }}} {{ name }}
              </a>
            </li>
            {{/suits}}
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <button id="{{_}}ask-button" type="button"
              class="btn btn-primary navbar-btn" disabled>Please</button>
    </li>
  </div>
  
  <div id="score-template" class="mustache">
    {{#scores}}
    <dt>{{ name }}</dt>
    <dd>
      {{#hand_size}}
      <span class="text-danger">
        {{#single_card}}1 card left{{/single_card}}
        {{^single_card}}{{hand_size}} cards left{{/single_card}}
      </span>
      {{/hand_size}}
      <ul class="list-unstyled">
      {{#ranks}}
        <li>{{{ symbol }}} {{ name }}</li>
      {{/ranks}}
      </ul>
    </dd>
    {{/scores}}
  </div>

  <!-- End Mustache templates -->
  
  <script data-main="/js/main" src="/js/lib/require.js"></script>
</body>
</html>
